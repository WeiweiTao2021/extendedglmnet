<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Introduction to `extenedglmnet` • extendedglmnet</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to `extenedglmnet`">
<meta property="og:description" content="extendedglmnet">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">extendedglmnet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/extendedglmnet.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An Introduction to
<code>extenedglmnet</code>
</h1>
                        <h4 data-toc-skip class="author">Weiwei Tao</h4>
            
            <h4 data-toc-skip class="date">May 03, 2022</h4>
      
      
      <div class="hidden name"><code>extendedglmnet.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>extendedglmnet package is an extension of glmnet package. Users can
either fit a linear model or generalized linear model depending the
response variable types. It can support ridge, lasso and random lasso
methods. User can choose to use cross validation to find the optimal
regularization parameter lambda or use user specified lambda. It can
deal with both continuous and binary responses. The package includes
methods for prediction and print, and evalution.</p>
<p>The authors of extendedglmnet is Weiwei Tao. This vignette describes
basic usage of extendedglmnet in R.</p>
<p>Lasso and ridge regulation are known to be suffering from that it can
select only one or a few of a set of highly correlated important
variables. If several independent data sets were generated from the same
distribution, then we would expect lasso to select nonidentical subsets
of those highly correlated important variables from different data sets.
Random Lasso proposed by Sijian Wang et al. solved this issue by using
bootstrap, which will provide more stable results than lasso and ridge
when number of predictors are greater than number of observations.
Random lasso algorithm is a two-step approach including: - step1: the
lasso method is applied to many bootstrap samples, each using a set of
randomly selected covariates. A measure of importance is yielded from
this step for each covariate. - step2: a similar procedure to the first
step is implemented with the exception that for each bootstrap sample, a
subset of covariates is randomly selected with unequal selection
probabil- ities determined by the covariates’ importance. The final set
of covariates and their coefficients are determined by averaging boot-
strap results obtained from step 2.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Like many other R packages, the simplest way to obtain
<code>extendedglmnet</code> is to install it directly from CRAN. Type
the following command in R console:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"extendedglmnet"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>The purpose of this section is to give users a general sense of the
package. We will briefly go over the main functions, basic operations
and outputs. After this section, users may have a better idea of what
functions are available, which ones to use, or at least where to seek
help.</p>
<p>First, we load the <code>extendedglmnet</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">extendedglmnet</span><span class="op">)</span></code></pre></div>
<p>The default family used in the package is the Guassian linear model
or “least squares”, which we will demonstrate in this section. We
generate data sample as following:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">size</span> <span class="op">=</span> <span class="fl">50</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">55</span><span class="op">*</span><span class="va">size</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">55</span><span class="op">)</span>
<span class="va">y</span> <span class="op">=</span> <span class="fl">10</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">3</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">20</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">10</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="fl">5</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">35</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>We split the data into training set and testing set with ratio of
7:3.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">size</span>, <span class="fl">0.7</span><span class="op">*</span><span class="va">size</span><span class="op">)</span>
<span class="va">trainx</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">index</span>,<span class="op">]</span>
<span class="va">testx</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="va">index</span>,<span class="op">]</span>
<span class="va">trainy</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">index</span><span class="op">]</span>
<span class="va">testy</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="op">-</span><span class="va">index</span><span class="op">]</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="linear-regression-family-gaussian-type-regression-default">Linear Regression:
<code>family = "gaussian", type = "regression"</code> (default)<a class="anchor" aria-label="anchor" href="#linear-regression-family-gaussian-type-regression-default"></a>
</h2>
<p><code>"gaussian"</code> is the default <code>family</code> argument
for the function <code>extendedglmnet</code>. We can fit the model
using:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.lr</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/extendedglmnet.html">extendedglmnet</a></span><span class="op">(</span><span class="va">trainx</span>, <span class="va">trainy</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, type <span class="op">=</span> <span class="st">"regression"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = y ~ ., data = dat)</span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">## (Intercept)           x1           x2           x3           x4           x5  </span>
<span class="co">##     234.534       -4.395      -10.466      103.262       41.824      -30.987  </span>
<span class="co">##          x6           x7           x8           x9          x10          x11  </span>
<span class="co">##       1.573        2.286       95.103       53.877       34.374      -35.808  </span>
<span class="co">##         x12          x13          x14          x15          x16          x17  </span>
<span class="co">##     -54.297       -8.345     -116.068       40.402        2.368      -46.211  </span>
<span class="co">##         x18          x19          x20          x21          x22          x23  </span>
<span class="co">##     -24.470      -21.003      -79.887      -36.785      -91.541     -128.501  </span>
<span class="co">##         x24          x25          x26          x27          x28          x29  </span>
<span class="co">##     -60.846     -116.194       -2.779      -35.108      -20.458      113.428  </span>
<span class="co">##         x30          x31          x32          x33          x34          x35  </span>
<span class="co">##     -60.440      -33.441       73.786      -34.391       35.729           NA  </span>
<span class="co">##         x36          x37          x38          x39          x40          x41  </span>
<span class="co">##          NA           NA           NA           NA           NA           NA  </span>
<span class="co">##         x42          x43          x44          x45          x46          x47  </span>
<span class="co">##          NA           NA           NA           NA           NA           NA  </span>
<span class="co">##         x48          x49          x50          x51          x52          x53  </span>
<span class="co">##          NA           NA           NA           NA           NA           NA  </span>
<span class="co">##         x54          x55  </span>
<span class="co">##          NA           NA</span></code></pre>
<p><code>fit</code> is a list that contains all the relevant information
of the fitted model for further use including type of the fit, family,
coefficient of the model, lambda (0 for regression without regulations),
degree of freedom (number of non-zero coefficients), number of
observations and number of covariates in the input matrix x. Two methods
are provided for the object such as
<code>print.extendglmnet, and</code>, <code>predict.extendglmnet</code>
that enable us to explore the results elegantly.</p>
<p>We can visualize the fitted results by
<code>print.extendglmnet</code> method:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/print.extendglmnet.html">print.extendglmnet</a></span><span class="op">(</span><span class="va">fit.lr</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call: linear regression for gaussian reponses</span>
<span class="co">## </span>
<span class="co">## (Intercept)          x1          x2          x3          x4          x5 </span>
<span class="co">##  234.534492   -4.395412  -10.465504  103.261699   41.823914  -30.987498 </span>
<span class="co">##          x6          x7          x8          x9         x10         x11 </span>
<span class="co">##    1.572516    2.286205   95.103248   53.877184   34.373551  -35.807994 </span>
<span class="co">##         x12         x13         x14         x15         x16         x17 </span>
<span class="co">##  -54.296960   -8.345191 -116.067687   40.402159    2.367541  -46.210841 </span>
<span class="co">##         x18         x19         x20         x21         x22         x23 </span>
<span class="co">##  -24.470255  -21.002875  -79.886678  -36.784803  -91.540994 -128.500889 </span>
<span class="co">##         x24         x25         x26         x27         x28         x29 </span>
<span class="co">##  -60.845730 -116.193756   -2.778896  -35.107516  -20.457893  113.428324 </span>
<span class="co">##         x30         x31         x32         x33         x34         x35 </span>
<span class="co">##  -60.439972  -33.440597   73.786391  -34.390843   35.729003          NA </span>
<span class="co">##         x36         x37         x38         x39         x40         x41 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##         x42         x43         x44         x45         x46         x47 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##         x48         x49         x50         x51         x52         x53 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##         x54         x55 </span>
<span class="co">##          NA          NA </span>
<span class="co">## Degrees of Freedom: 34 Total (i.e. Null); 0 Residual</span></code></pre>
<p>The training dataset contains 35 observations and 55 potential
predictors. The number of predictors are greater than number of
obervations. Traditional linear regression will automatically assign NA
values to the last 20 covariates.</p>
<p>We can predict responses based upon new data we have.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ypred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.extendglmnet.html">predict.extendglmnet</a></span><span class="op">(</span><span class="va">fit.lr</span>, newx <span class="op">=</span> <span class="va">testx</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in predict.extendglmnet(fit.lr, newx = testx, type = "response"):</span>
<span class="co">## prediction from a rank-deficient fit may be misleading</span></code></pre>
<p>The results may be misleading due to rank-deficient issue. We can
also perform model evaluation by calculating MSE, RMSE, MAE for
continuous responses.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"MSE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 7899.778</span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"RMSE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 88.8807</span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"MAE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 72.87855</span></code></pre>
</div>
<div class="section level2">
<h2 id="ridgelasso-regression-family-gaussian-type-ridge-or-lasso">Ridge/Lasso Regression:
<code>family = "gaussian", type = "ridge" or "lasso"</code><a class="anchor" aria-label="anchor" href="#ridgelasso-regression-family-gaussian-type-ridge-or-lasso"></a>
</h2>
<p>We can also choose to fit our model with either ridge or lasso
regulations by changing type assigned.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.ridge</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/extendedglmnet.html">extendedglmnet</a></span><span class="op">(</span><span class="va">trainx</span>, <span class="va">trainy</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, type <span class="op">=</span> <span class="st">"ridge"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## &lt;sparse&gt;[ &lt;logic&gt; ] : .M.sub.i.logical() maybe inefficient</span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/print.extendglmnet.html">print.extendglmnet</a></span><span class="op">(</span><span class="va">fit.ridge</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call: ridge for gaussian reponses</span>
<span class="co">## </span>
<span class="co">## 56 x 1 sparse Matrix of class "dgCMatrix"</span>
<span class="co">##                      s0</span>
<span class="co">## (Intercept) 14.84559090</span>
<span class="co">## x1           1.48235919</span>
<span class="co">## x2           0.67504859</span>
<span class="co">## x3           0.17004143</span>
<span class="co">## x4           1.41266799</span>
<span class="co">## x5          -0.36820573</span>
<span class="co">## x6           0.22601533</span>
<span class="co">## x7           0.02715191</span>
<span class="co">## x8           0.29675852</span>
<span class="co">## x9           0.24126590</span>
<span class="co">## x10          0.40772928</span>
<span class="co">## x11          0.02954644</span>
<span class="co">## x12         -0.26531619</span>
<span class="co">## x13         -0.10242405</span>
<span class="co">## x14          0.82999393</span>
<span class="co">## x15         -1.03387308</span>
<span class="co">## x16         -0.10339420</span>
<span class="co">## x17         -0.01675233</span>
<span class="co">## x18         -0.03876118</span>
<span class="co">## x19         -0.17222405</span>
<span class="co">## x20          0.14325276</span>
<span class="co">## x21         -0.22541259</span>
<span class="co">## x22          0.26600614</span>
<span class="co">## x23          0.05879581</span>
<span class="co">## x24         -0.10873735</span>
<span class="co">## x25          0.03319100</span>
<span class="co">## x26          0.03478869</span>
<span class="co">## x27         -0.20242101</span>
<span class="co">## x28          0.28230668</span>
<span class="co">## x29          0.09377049</span>
<span class="co">## x30         -0.38389699</span>
<span class="co">## x31          0.08828820</span>
<span class="co">## x32         -0.05915957</span>
<span class="co">## x33         -0.20608398</span>
<span class="co">## x34         -0.05500836</span>
<span class="co">## x35          1.14702970</span>
<span class="co">## x36         -0.02311763</span>
<span class="co">## x37          0.03164328</span>
<span class="co">## x38         -0.26160401</span>
<span class="co">## x39          0.09312582</span>
<span class="co">## x40         -0.57783753</span>
<span class="co">## x41         -0.20235873</span>
<span class="co">## x42          0.32250464</span>
<span class="co">## x43          0.01949068</span>
<span class="co">## x44         -0.14417950</span>
<span class="co">## x45          0.10725765</span>
<span class="co">## x46         -0.08028361</span>
<span class="co">## x47          0.15142094</span>
<span class="co">## x48         -0.04203806</span>
<span class="co">## x49          0.09928117</span>
<span class="co">## x50          0.22967396</span>
<span class="co">## x51         -0.61158049</span>
<span class="co">## x52          0.03295511</span>
<span class="co">## x53          0.08846090</span>
<span class="co">## x54          0.24194680</span>
<span class="co">## x55         -0.15472360</span>
<span class="co">## Degrees of Freedom: 34 Total (i.e. Null); -21 Residual</span></code></pre>
<p>Similarly, we can predict responses based upon new testing data we
have.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ypred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.extendglmnet.html">predict.extendglmnet</a></span><span class="op">(</span><span class="va">fit.ridge</span>, newx <span class="op">=</span> <span class="va">testx</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></code></pre></div>
<p>The MSE by using ridge regression is much smaller than that using
linear regression without regulation.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"MSE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 12.36762</span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"RMSE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 3.516762</span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"MAE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 2.321207</span></code></pre>
<p>The MSE with lasso is the smallest as comparing to Ridge and linear
regression.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.lasso</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/extendedglmnet.html">extendedglmnet</a></span><span class="op">(</span><span class="va">trainx</span>, <span class="va">trainy</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, type <span class="op">=</span> <span class="st">"lasso"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## &lt;sparse&gt;[ &lt;logic&gt; ] : .M.sub.i.logical() maybe inefficient</span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ypred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.extendglmnet.html">predict.extendglmnet</a></span><span class="op">(</span><span class="va">fit.lasso</span>, newx <span class="op">=</span> <span class="va">testx</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"MSE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1.831474</span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"RMSE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1.35332</span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"MAE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1.179915</span></code></pre>
<div class="section level3">
<h3 id="function-arguments-for-choice-of-lambdas">function arguments for choice of lambdas<a class="anchor" aria-label="anchor" href="#function-arguments-for-choice-of-lambdas"></a>
</h3>
<p><code>extendedglmnet</code> provides various arguments for users to
customize the cross validation process during the fit.</p>
<ul>
<li><p><code>cv</code> is an indicator variable to specify whether cross
validation should be used to pick optimal lambda value. Default is
TRUE.</p></li>
<li><p><code>lambda</code> A user supplied lambda sequence. Typical
usage is to have the program compute its own lambda sequence with
default values in glmnet package. Supplying a value of lambda overrides
this.</p></li>
<li><p><code>nfolds</code> number of folds - default is 5. Although
nfolds can be as large as the sample size (leave-one-out CV), it is not
recommended for large datasets. Smallest value allowable is nfolds =
3.</p></li>
</ul>
<p>As an example, we can specify user defined range of lambdas during
the cross validation process of the fit.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grid</span><span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">6</span>,<span class="op">-</span><span class="fl">2</span>,length<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="va">fit.lasso</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/extendedglmnet.html">extendedglmnet</a></span><span class="op">(</span><span class="va">trainx</span>, <span class="va">trainy</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, type <span class="op">=</span> <span class="st">"lasso"</span>, lambda <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## &lt;sparse&gt;[ &lt;logic&gt; ] : .M.sub.i.logical() maybe inefficient</span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ypred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.extendglmnet.html">predict.extendglmnet</a></span><span class="op">(</span><span class="va">fit.lasso</span>, newx <span class="op">=</span> <span class="va">testx</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"MSE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1.741582</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="random-lasso-method-family-gaussian-type-random-lasso">Random Lasso Method:
<code>family = "gaussian", type = "random lasso"</code><a class="anchor" aria-label="anchor" href="#random-lasso-method-family-gaussian-type-random-lasso"></a>
</h2>
<p>So far, what we have introduced were the same as what provided in the
glmnet package. An important feature in extendedglmnet package is that
it provide use the choice of random lasso method which can provide more
stable fitting results.</p>
<p>For random lasso method, 3 additional parameters need to specified: *
<code>B</code> number of bootstrap samples in random lasso. One can take
B = 500 or B = 1000. The default is 200. A large B can make computation
time much longer.</p>
<ul>
<li>
<code>q1</code> and <code>q2</code> number of candidate variables to
be included in each bootstrap sample during generating importance
measures in random lasso. This value need to be tuned to ensure best
performance. The value should be positive and no greater than number of
predictors in x.</li>
</ul>
<p>We leave B as the default of 200 and choose q1 and q2 to be 30.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.rl</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/extendedglmnet.html">extendedglmnet</a></span><span class="op">(</span><span class="va">trainx</span>, <span class="va">trainy</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, type <span class="op">=</span> <span class="st">"random lasso"</span>, q1 <span class="op">=</span> <span class="fl">30</span>, q2 <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>
<span class="fu"><a href="../reference/print.extendglmnet.html">print.extendglmnet</a></span><span class="op">(</span><span class="va">fit.rl</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call: random lasso for gaussian reponses</span>
<span class="co">## </span>
<span class="co">##   (Intercept)            x1            x2            x3            x4 </span>
<span class="co">##  3.8514374202  8.8803633922  2.8951474345  0.1383117243  8.9090314336 </span>
<span class="co">##            x5            x6            x7            x8            x9 </span>
<span class="co">## -0.0686277945  0.2642956239  0.0047280339  0.0342609754  0.1368621145 </span>
<span class="co">##           x10           x11           x12           x13           x14 </span>
<span class="co">##  0.2141046862  0.0162787556 -0.0245048738 -0.1632200579  1.5308497190 </span>
<span class="co">##           x15           x16           x17           x18           x19 </span>
<span class="co">## -1.6974635048  0.0253334822  0.0104445070  0.0066722719  0.0000000000 </span>
<span class="co">##           x20           x21           x22           x23           x24 </span>
<span class="co">##  0.4523053335 -0.5260807691  0.0725227865 -0.0110449314 -0.2211359781 </span>
<span class="co">##           x25           x26           x27           x28           x29 </span>
<span class="co">##  0.0049706804  0.0498357188 -0.0556021454  0.1525768941  0.1476523067 </span>
<span class="co">##           x30           x31           x32           x33           x34 </span>
<span class="co">## -0.3200611634  0.0029533077  0.1378537711  0.0788565166 -0.0001590397 </span>
<span class="co">##           x35           x36           x37           x38           x39 </span>
<span class="co">##  4.9998382014 -0.5887481631 -0.0147553009 -0.1971575295  0.0134130332 </span>
<span class="co">##           x40           x41           x42           x43           x44 </span>
<span class="co">## -0.4805432076 -0.0778754440  0.4346041118 -0.0038781803  0.0304749092 </span>
<span class="co">##           x45           x46           x47           x48           x49 </span>
<span class="co">## -0.0378947594  0.0103509862 -0.0490118960 -0.0507775345  0.0630772691 </span>
<span class="co">##           x50           x51           x52           x53           x54 </span>
<span class="co">##  0.3652174418 -0.5731086119 -0.5595950544  0.3223912543  0.2428034972 </span>
<span class="co">##           x55 </span>
<span class="co">##  0.0951881378 </span>
<span class="co">## Degrees of Freedom: 34 Total (i.e. Null); -20 Residual</span></code></pre>
<p>The MSE with random lasso is comparable to that of lasso.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ypred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.extendglmnet.html">predict.extendglmnet</a></span><span class="op">(</span><span class="va">fit.rl</span>, newx <span class="op">=</span> <span class="va">testx</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"MSE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 2.551532</span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"RMSE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1.597352</span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"MAE"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1.392177</span></code></pre>
</div>
<div class="section level2">
<h2 id="logistic-regression-family-binomial-type-regression">Logistic Regression:
<code>family = "binomial", type = "regression"</code><a class="anchor" aria-label="anchor" href="#logistic-regression-family-binomial-type-regression"></a>
</h2>
<p>extendedglmnet package supports binomial responses as well. Similarly
we generated a simulated dataset and first apply logistic regression to
that dataset.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">size</span> <span class="op">=</span> <span class="fl">200</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">210</span><span class="op">*</span><span class="va">size</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">210</span><span class="op">)</span>
<span class="va">z</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">3</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">40</span><span class="op">]</span> <span class="op">-</span> <span class="fl">4</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">50</span><span class="op">]</span> <span class="op">+</span> <span class="fl">3</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">210</span><span class="op">]</span>
<span class="va">pr</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>
<span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">size</span>,<span class="fl">1</span>,<span class="va">pr</span><span class="op">)</span>

<span class="va">index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">size</span>, <span class="fl">0.7</span><span class="op">*</span><span class="va">size</span><span class="op">)</span>
<span class="va">trainx</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">index</span>,<span class="op">]</span>
<span class="va">testx</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="va">index</span>,<span class="op">]</span>
<span class="va">trainy</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">index</span><span class="op">]</span>
<span class="va">testy</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="op">-</span><span class="va">index</span><span class="op">]</span></code></pre></div>
<p>For binary responses, we need simply change family argument from
“gaussian” to “binomial”.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.logistic</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/extendedglmnet.html">extendedglmnet</a></span><span class="op">(</span><span class="va">trainx</span>, <span class="va">trainy</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, type <span class="op">=</span> <span class="st">"regression"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: glm.fit: algorithm did not converge</span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/print.extendglmnet.html">print.extendglmnet</a></span><span class="op">(</span><span class="va">fit.logistic</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call: logistic regression for binomial reponses</span>
<span class="co">## </span>
<span class="co">## (Intercept)          x1          x2          x3          x4          x5 </span>
<span class="co">##  170.728494 -189.002694  250.450445  309.836529 -200.100970  -62.949288 </span>
<span class="co">##          x6          x7          x8          x9         x10         x11 </span>
<span class="co">##  -37.779943   34.685518  160.093405 -334.598568  -23.852462  -49.589891 </span>
<span class="co">##         x12         x13         x14         x15         x16         x17 </span>
<span class="co">## -631.242904   55.381877  122.821364  -91.920710  357.032252  332.965762 </span>
<span class="co">##         x18         x19         x20         x21         x22         x23 </span>
<span class="co">## -480.182654 -241.387893    3.718636  197.313505  -92.322501   10.649430 </span>
<span class="co">##         x24         x25         x26         x27         x28         x29 </span>
<span class="co">##  266.353534  192.849958   75.613113 -352.794024 -301.266977 -213.882911 </span>
<span class="co">##         x30         x31         x32         x33         x34         x35 </span>
<span class="co">##  -23.709924  303.453574 -333.373354  869.900230   21.384230 -210.871775 </span>
<span class="co">##         x36         x37         x38         x39         x40         x41 </span>
<span class="co">## -371.893041 -119.978960 -628.873543   93.788467 -568.174405 -263.461357 </span>
<span class="co">##         x42         x43         x44         x45         x46         x47 </span>
<span class="co">## -295.819631  224.892197 -395.152503 -252.475535 -324.250292 -116.989606 </span>
<span class="co">##         x48         x49         x50         x51         x52         x53 </span>
<span class="co">##   25.269718 -175.148372  -31.366221 -385.464830  -39.200921 -173.376483 </span>
<span class="co">##         x54         x55         x56         x57         x58         x59 </span>
<span class="co">##   12.891372 -153.951867 -175.873423   85.595482 -297.963257 -351.681271 </span>
<span class="co">##         x60         x61         x62         x63         x64         x65 </span>
<span class="co">## -224.976481  330.453066  129.941227   71.550222 -105.654966  158.536854 </span>
<span class="co">##         x66         x67         x68         x69         x70         x71 </span>
<span class="co">## -485.962500 -133.280392   51.674099   21.694105  133.869629 -396.731781 </span>
<span class="co">##         x72         x73         x74         x75         x76         x77 </span>
<span class="co">## -446.523654 -303.232929 -842.255218  -26.733936   32.204663  149.827085 </span>
<span class="co">##         x78         x79         x80         x81         x82         x83 </span>
<span class="co">## -456.199153 -132.153159 -163.894375 -179.575046  327.681763  -48.416568 </span>
<span class="co">##         x84         x85         x86         x87         x88         x89 </span>
<span class="co">##  -96.098724  150.688206 -179.606634 -273.256138  -33.885985   56.509632 </span>
<span class="co">##         x90         x91         x92         x93         x94         x95 </span>
<span class="co">## -377.829885  117.172043   96.695160 -130.827131  127.791584   91.190783 </span>
<span class="co">##         x96         x97         x98         x99        x100        x101 </span>
<span class="co">##    5.280105  262.156984   92.062556 -261.070756   94.615290  580.544386 </span>
<span class="co">##        x102        x103        x104        x105        x106        x107 </span>
<span class="co">##   26.155971  263.449773  407.193883  316.351653  113.807338  401.215387 </span>
<span class="co">##        x108        x109        x110        x111        x112        x113 </span>
<span class="co">##   47.651263 -442.330028   23.283824 -166.912030  -57.440727  -17.681013 </span>
<span class="co">##        x114        x115        x116        x117        x118        x119 </span>
<span class="co">## -569.795919   -7.055063  389.760714 -398.009088 -305.652147 -316.164927 </span>
<span class="co">##        x120        x121        x122        x123        x124        x125 </span>
<span class="co">##  -68.913041 -128.481368 -355.718537  195.749704  152.178476 -341.443464 </span>
<span class="co">##        x126        x127        x128        x129        x130        x131 </span>
<span class="co">##  544.389155  -92.920339  109.942789  -16.886289  200.043607  352.552211 </span>
<span class="co">##        x132        x133        x134        x135        x136        x137 </span>
<span class="co">##   34.450447  333.348131  -20.121271 -320.016391  442.750471   66.188170 </span>
<span class="co">##        x138        x139        x140        x141        x142        x143 </span>
<span class="co">## -117.702398 -342.272824          NA          NA          NA          NA </span>
<span class="co">##        x144        x145        x146        x147        x148        x149 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##        x150        x151        x152        x153        x154        x155 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##        x156        x157        x158        x159        x160        x161 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##        x162        x163        x164        x165        x166        x167 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##        x168        x169        x170        x171        x172        x173 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##        x174        x175        x176        x177        x178        x179 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##        x180        x181        x182        x183        x184        x185 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##        x186        x187        x188        x189        x190        x191 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##        x192        x193        x194        x195        x196        x197 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##        x198        x199        x200        x201        x202        x203 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##        x204        x205        x206        x207        x208        x209 </span>
<span class="co">##          NA          NA          NA          NA          NA          NA </span>
<span class="co">##        x210 </span>
<span class="co">##          NA </span>
<span class="co">## Degrees of Freedom: 139 Total (i.e. Null); 0 Residual</span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ypred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.extendglmnet.html">predict.extendglmnet</a></span><span class="op">(</span><span class="va">fit.logistic</span>, newx <span class="op">=</span> <span class="va">testx</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, type <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in predict.extendglmnet(fit.logistic, newx = testx, family =</span>
<span class="co">## "binomial", : prediction from a rank-deficient fit may be misleading</span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"accuracy"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.55</span></code></pre>
<div class="section level3">
<h3 id="predicting-with-extendedglmnet-objects-for-binary-responses">Predicting with <code>extendedglmnet</code> objects for binary
responses<a class="anchor" aria-label="anchor" href="#predicting-with-extendedglmnet-objects-for-binary-responses"></a>
</h3>
<p>For binary responses, three types of predictions are available. Type
“link” gives the linear predictors for “binomial” models. Type
“response” gives the fitted probabilities. Type “class” applies only to
“binomial” models, and produces the class label corresponding to the
maximum probability. If no levels argument were specifies, the class
will be labeled as 0 or 1 classes.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ypred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.extendglmnet.html">predict.extendglmnet</a></span><span class="op">(</span><span class="va">fit.logistic</span>, newx <span class="op">=</span> <span class="va">testx</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in predict.extendglmnet(fit.logistic, newx = testx, family =</span>
<span class="co">## "binomial", : prediction from a rank-deficient fit may be misleading</span></code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">ypred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      [,1] [,2] [,3]          [,4] [,5]          [,6]         [,7] [,8] [,9]</span>
<span class="co">## [1,]  Inf    0    0 6.293635e-130    0 3.911972e-224 1.327804e-05  Inf    0</span>
<span class="co">##      [,10]        [,11] [,12] [,13] [,14] [,15] [,16] [,17]         [,18] [,19]</span>
<span class="co">## [1,]     0 7.58419e-174     0   Inf     0     0     0     0 2.152799e-247     0</span>
<span class="co">##      [,20] [,21] [,22] [,23] [,24]     [,25] [,26] [,27] [,28]         [,29]</span>
<span class="co">## [1,]     0   Inf   Inf   Inf     0 710117036     0   Inf     0 1.507372e+112</span>
<span class="co">##              [,30]         [,31]         [,32] [,33]        [,34] [,35] [,36]</span>
<span class="co">## [1,] 8.152083e-322 5.825336e+286 2.333521e+286   Inf 2.580635e+96   Inf   Inf</span>
<span class="co">##              [,37]         [,38] [,39] [,40] [,41]        [,42] [,43] [,44]</span>
<span class="co">## [1,] 1.220839e+244 2.865581e-322     0   Inf   Inf 2.896271e-61   Inf     0</span>
<span class="co">##      [,45] [,46] [,47] [,48] [,49] [,50] [,51]         [,52] [,53]</span>
<span class="co">## [1,]   Inf     0   Inf     0   Inf     0   Inf 1.027496e+263     0</span>
<span class="co">##              [,54] [,55] [,56] [,57] [,58] [,59] [,60]</span>
<span class="co">## [1,] 7.381963e-218   Inf     0     0     0   Inf     0</span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ypred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.extendglmnet.html">predict.extendglmnet</a></span><span class="op">(</span><span class="va">fit.logistic</span>, newx <span class="op">=</span> <span class="va">testx</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in predict.extendglmnet(fit.logistic, newx = testx, family =</span>
<span class="co">## "binomial", : prediction from a rank-deficient fit may be misleading</span></code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">ypred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      [,1] [,2] [,3] [,4] [,5] [,6]      [,7] [,8] [,9] [,10] [,11] [,12] [,13]</span>
<span class="co">## [1,]    0    1    1    1    1    1 0.9999867    0    1     1     1     1     0</span>
<span class="co">##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]</span>
<span class="co">## [1,]     1     1     1     1     1     1     1     0     0     0     1</span>
<span class="co">##             [,25] [,26] [,27] [,28]         [,29] [,30]         [,31]</span>
<span class="co">## [1,] 1.408219e-09     1     0     1 6.634061e-113     1 1.716639e-287</span>
<span class="co">##             [,32] [,33]        [,34] [,35] [,36]        [,37] [,38] [,39] [,40]</span>
<span class="co">## [1,] 4.28537e-287     0 3.875015e-97     0     0 8.19109e-245     1     1     0</span>
<span class="co">##      [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48] [,49] [,50] [,51]</span>
<span class="co">## [1,]     0     1     0     1     0     1     0     1     0     1     0</span>
<span class="co">##              [,52] [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60]</span>
<span class="co">## [1,] 9.732401e-264     1     1     0     1     1     1     0     1</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="regression-with-regulations-family-binomial-type-lasso-or-ridge">Regression with regulations:
<code>family = "binomial", type = "lasso" or "ridge"</code><a class="anchor" aria-label="anchor" href="#regression-with-regulations-family-binomial-type-lasso-or-ridge"></a>
</h2>
<p>Similarly, we can apply logistic regression with ridge or lasso
regulations to the same dataset. The prediciton accuracy is the highest
with lasso (0.87), following that with ridge regulation (0.75) and is
the lowest for model without regulation (0.38).</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.ridge</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/extendedglmnet.html">extendedglmnet</a></span><span class="op">(</span><span class="va">trainx</span>, <span class="va">trainy</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, type <span class="op">=</span> <span class="st">"ridge"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## &lt;sparse&gt;[ &lt;logic&gt; ] : .M.sub.i.logical() maybe inefficient</span></code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ypred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.extendglmnet.html">predict.extendglmnet</a></span><span class="op">(</span><span class="va">fit.ridge</span>, newx <span class="op">=</span> <span class="va">testx</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, type <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span>
<span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"accuracy"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.75</span></code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.lasso</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/extendedglmnet.html">extendedglmnet</a></span><span class="op">(</span><span class="va">trainx</span>, <span class="va">trainy</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, type <span class="op">=</span> <span class="st">"lasso"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## &lt;sparse&gt;[ &lt;logic&gt; ] : .M.sub.i.logical() maybe inefficient</span></code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ypred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.extendglmnet.html">predict.extendglmnet</a></span><span class="op">(</span><span class="va">fit.lasso</span>, newx <span class="op">=</span> <span class="va">testx</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, type <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span>
<span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"accuracy"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.8833333</span></code></pre>
</div>
<div class="section level2">
<h2 id="random-lasso-family-binomial-type-random-lasso">Random Lasso:
<code>family = "binomial", type = "random lasso"</code><a class="anchor" aria-label="anchor" href="#random-lasso-family-binomial-type-random-lasso"></a>
</h2>
<p>We tested random lasso model to the same dataset as well. q1 and q2
are set to be 150. The prediction is the highest with random lasso which
is 0.9.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.rl</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/extendedglmnet.html">extendedglmnet</a></span><span class="op">(</span><span class="va">trainx</span>, <span class="va">trainy</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, type <span class="op">=</span> <span class="st">"random lasso"</span><span class="op">)</span>
<span class="va">ypred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.extendglmnet.html">predict.extendglmnet</a></span><span class="op">(</span><span class="va">fit.rl</span>, newx <span class="op">=</span> <span class="va">testx</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, type <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span>
<span class="fu"><a href="../reference/evaluation.html">evaluation</a></span><span class="op">(</span><span class="va">testy</span>, <span class="va">ypred</span>, <span class="st">"accuracy"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.85</span></code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Wang, S., Nan, B., Rosset, S., &amp; Zhu, J. (2011). Random
lasso, The annals of applied statistics, 5(1), 468.</p></li>
<li><p>Friedman J, Hastie T, Tibshirani R (2010). Regularization Paths
for Generalized Linear Models via Coordinate Descent. Journal of
Statistical Software, 33(1), 1–22. doi: 10.18637/jss.v033.i01, <a href="https://www.jstatsoft.org/v33/i01/" class="external-link uri">https://www.jstatsoft.org/v33/i01/</a>.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Weiwei Tao.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
